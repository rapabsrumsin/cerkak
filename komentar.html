<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Komentar Pembaca</title>
  <style>
    :root{
      --bg: #faf9f6;
      --accent: #e07a5f;
      --muted: #777;
      --card: #fff;
      --shadow: rgba(30,30,30,0.08);
      --max-width: 760px;
    }
    html,body{
      height:100%;
      margin:0;
      font-family: "Helvetica Neue", Arial, sans-serif;
      background: linear-gradient(180deg, #fff 0%, var(--bg) 100%);
      color:#222;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .wrap{
      max-width: var(--max-width);
      margin:28px auto;
      padding:20px;
    }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:16px;
    }
    header h1{
      font-size:20px;
      margin:0;
      letter-spacing:0.2px;
    }
    header small{ color:var(--muted); }

    .notebook {
      background: linear-gradient(180deg, #fff 0%, #fff 100%);
      border: 1px solid #e7e3df;
      box-shadow: 0 6px 18px var(--shadow);
      border-radius:10px;
      overflow: hidden;
    }

    .page{
      display:grid;
      grid-template-columns: 44px 1fr;
      gap:0;
      align-items:start;
      padding:18px;
    }

    /* Left margin boxes (menyerupai kotak di samping kertas) */
    .side {
      padding-top:6px;
      display:flex;
      flex-direction:column;
      gap:8px;
      align-items:center;
    }
    .side .box{
      width:24px;
      height:18px;
      border:2px solid #efefef;
      border-radius:4px;
      box-sizing:border-box;
      background:linear-gradient(180deg,#fff,#fafafa);
    }

    /* Main content */
    .content{
      padding-left:12px;
    }

    form{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-bottom:12px;
    }

    label{
      font-size:14px;
      color:#333;
    }

    .row{
      display:flex;
      gap:12px;
      align-items:center;
    }

    input[type="text"]{
      width:320px;
      max-width:100%;
      padding:8px 10px;
      border:1px solid #d8d6d3;
      border-radius:6px;
      box-sizing:border-box;
      font-size:14px;
    }

    textarea{
      min-height:84px;
      padding:10px;
      border:1px solid #d8d6d3;
      border-radius:6px;
      font-size:14px;
      resize:vertical;
      box-sizing:border-box;
      max-width:100%;
    }

    .controls{
      display:flex;
      gap:12px;
      align-items:center;
      margin-top:4px;
    }

    button{
      background:var(--accent);
      color:white;
      border:none;
      padding:9px 14px;
      border-radius:6px;
      cursor:pointer;
      font-weight:600;
      box-shadow: 0 4px 10px rgba(224,122,95,0.18);
    }
    button[disabled]{
      opacity:0.55;
      cursor:default;
      box-shadow:none;
    }

    .note{
      font-size:13px;
      color:var(--muted);
    }

    /* Table / list for comments */
    .list{
      margin-top:8px;
      border-top:1px dashed #eee;
      padding-top:12px;
    }

    .list .row-head{
      display:flex;
      gap:12px;
      font-weight:600;
      color:#333;
      margin-bottom:8px;
    }
    .list .row-head > div{
      flex:1;
    }

    .comment{
      display:flex;
      gap:12px;
      align-items:flex-start;
      padding:10px 6px;
      border-radius:6px;
      background:linear-gradient(180deg,#fff,#fff);
      border:1px solid #f1f0ef;
      margin-bottom:8px;
    }
    .comment .name{
      width:180px;
      max-width:35%;
      font-weight:700;
      color:#2b2b2b;
    }
    .comment .text{
      flex:1;
      color:#333;
      white-space:pre-wrap;
    }
    .comment .meta{
      display:flex;
      gap:8px;
      align-items:center;
      margin-left:12px;
    }
    .small-btn{
      border:1px solid #e3e1df;
      background:transparent;
      border-radius:6px;
      padding:6px 8px;
      cursor:pointer;
      font-size:13px;
    }

    .empty{
      color:var(--muted);
      padding:12px 6px;
    }

    /* responsiveness */
    @media (max-width:640px){
      .page{ grid-template-columns: 28px 1fr; padding:12px; }
      .side .box{ width:18px; height:14px; }
      .comment .name{ width:120px; max-width:40%; }
      input[type="text"]{ width:100%; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Komentar Pembaca</h1>
      <small>Halaman 2</small>
       <nav>
       <h3><a href="index.html">BERANDA</a></h3>
    </nav>
    </header>
    

    <section class="notebook" aria-label="Form komentar dan daftar komentar">
      <div class="page">
        <div class="side" aria-hidden="true">
          <!-- meniru kotak di pinggir kertas -->
          
        </div>

        <div class="content">
          <form id="commentForm" autocomplete="off" novalidate>
            <div>
              <label for="name">Nama</label><br />
              <input id="name" name="name" type="text" maxlength="60" placeholder="Tulis nama Anda..." required />
            </div>

            <div>
              <label for="comment">Komentar</label><br />
              <textarea id="comment" name="comment" maxlength="800" placeholder="Tulis komentar..." required></textarea>
            </div>

            <div class="controls">
              <button id="sendBtn" type="submit">Kirim</button>
              <button id="clearBtn" type="button" class="small-btn" title="Kosongkan form">Bersihkan</button>
              <div class="note" id="status" aria-live="polite" style="margin-left:8px"></div>
            </div>
          </form>

          <div class="list" aria-live="polite">
            <div class="row-head">
              <div>Nama</div>
              <div>Komentar</div>
              <div style="width:90px;text-align:right">Aksi</div>
            </div>

            <div id="commentsContainer" class="commentsContainer">
              <!-- komentar akan dimasukkan di sini -->
            </div>

          </div>
        </div>
      </div>
    </section>
  </div>

  <script>
    // Key localStorage
    const STORAGE_KEY = 'komentar_pembaca_v1';

    // DOM elements
    const form = document.getElementById('commentForm');
    const nameInput = document.getElementById('name');
    const commentInput = document.getElementById('comment');
    const sendBtn = document.getElementById('sendBtn');
    const clearBtn = document.getElementById('clearBtn');
    const statusEl = document.getElementById('status');
    const container = document.getElementById('commentsContainer');

    // Load comments from storage (array of objects {id, name, text, time})
    function loadComments(){
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        return raw ? JSON.parse(raw) : [];
      } catch(e) {
        console.error('Gagal membaca storage', e);
        return [];
      }
    }

    function saveComments(list){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
    }

    function renderComments(){
      const list = loadComments();
      container.innerHTML = '';
      if(list.length === 0){
        const e = document.createElement('div');
        e.className = 'empty';
        e.textContent = 'Belum ada komentar.';
        container.appendChild(e);
        return;
      }

      // render newest first
      const reversed = [...list].sort((a,b)=> b.time - a.time);
      reversed.forEach(item => {
        const row = document.createElement('div');
        row.className = 'comment';
        row.setAttribute('data-id', item.id);

        const nameDiv = document.createElement('div');
        nameDiv.className = 'name';
        nameDiv.textContent = item.name;

        const textDiv = document.createElement('div');
        textDiv.className = 'text';
        textDiv.textContent = item.text;

        const metaDiv = document.createElement('div');
        metaDiv.className = 'meta';

        const timeSmall = document.createElement('div');
        timeSmall.style.fontSize = '12px';
        timeSmall.style.color = '#666';
        timeSmall.textContent = (new Date(item.time)).toLocaleString();

        const delBtn = document.createElement('button');
        delBtn.className = 'small-btn';
        delBtn.title = 'Hapus komentar';
        delBtn.textContent = 'Hapus';
        delBtn.addEventListener('click', ()=> {
          if(confirm('Hapus komentar ini?')) {
            deleteComment(item.id);
          }
        });

        metaDiv.appendChild(timeSmall);
        metaDiv.appendChild(delBtn);

        row.appendChild(nameDiv);
        row.appendChild(textDiv);
        row.appendChild(metaDiv);

        container.appendChild(row);
      });
    }

    function addComment(name, text){
      const list = loadComments();
      const id = 'c_' + Date.now() + '_' + Math.floor(Math.random()*9000+1000);
      list.push({ id, name, text, time: Date.now() });
      saveComments(list);
      renderComments();
    }

    function deleteComment(id){
      let list = loadComments();
      list = list.filter(c => c.id !== id);
      saveComments(list);
      renderComments();
      statusEl.textContent = 'Komentar dihapus.';
      setTimeout(()=> statusEl.textContent = '', 2000);
    }

    // form submit
    form.addEventListener('submit', function(e){
      e.preventDefault();
      const name = nameInput.value.trim();
      const text = commentInput.value.trim();

      // validation
      if(!name){
        statusEl.textContent = 'Nama tidak boleh kosong.';
        nameInput.focus();
        return;
      }
      if(!text){
        statusEl.textContent = 'Komentar tidak boleh kosong.';
        commentInput.focus();
        return;
      }
      if(name.length > 60){
        statusEl.textContent = 'Panjang nama maksimal 60 karakter.';
        nameInput.focus();
        return;
      }
      if(text.length > 800){
        statusEl.textContent = 'Komentar terlalu panjang (maks 800).';
        commentInput.focus();
        return;
      }

      // disable button briefly to prevent spam
      sendBtn.disabled = true;
      addComment(name, text);
      form.reset();
      statusEl.textContent = 'Komentar terkirim!';
      setTimeout(()=> { statusEl.textContent=''; sendBtn.disabled = false; }, 1200);
    });

    clearBtn.addEventListener('click', ()=> {
      if(confirm('Kosongkan form?')) {
        form.reset();
        statusEl.textContent = '';
      }
    });

    // initial demo data (only if none present)
    (function initDemo(){
      const list = loadComments();
      if(list.length === 0){
        const demo = [
          { id:'d1', name:'Rafa', text:'Bagus tulisannya, informatif!', time: Date.now() - 1000*60*60 },
          { id:'d2', name:'rendy', text:'Perlu tambahan sumber di bagian 2.', time: Date.now() - 1000*60*30 }
        ];
        saveComments(demo);
      }
      renderComments();
    })();
   

  </script>
</body>
</html>
